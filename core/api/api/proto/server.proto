syntax = "proto3";
package proto;

service API {
    rpc Login(LoginRequest) returns (Response);
    rpc CreateCocoon(CreateCocoonRequest) returns (Response);
    rpc CreateRelease(CreateReleaseRequest) returns (Response);
    rpc GetRelease(GetReleaseRequest) returns (Response);
    rpc CreateIdentity(CreateIdentityRequest) returns (Response);
    rpc Deploy(DeployRequest) returns (Response);
    rpc GetCocoon(GetCocoonRequest) returns (Response);
    rpc GetIdentity(GetIdentityRequest) returns (Response);
    rpc AddCocoonToIdentity(AddCocoonToIdentityRequest) returns (Response);
}

message LoginRequest {
    string email = 1;
    string password = 2;
}

message AddCocoonToIdentityRequest {
    string email = 1;
    string cocoonId = 2;
}

message CreateCocoonRequest {
    string ID = 1;
    string URL = 2;
    string language = 3;
    string releaseTag = 4;
    string buildParam = 5;
    string memory = 6;
    string CPUShares = 7;
    repeated string releases = 8;
    string link = 9;
    int32 numSignatories = 10;
    int32 sigThreshold = 11;
    repeated string signatories = 12;
    
    // options for implementer
    bool optionAllowDuplicate = 13;
}

message GetCocoonRequest {
    string ID = 1;
}

message GetIdentityRequest {
    string email = 1;
    string ID = 2;
}

message CreateReleaseRequest {
    string ID = 1;
    string cocoonID = 2;
    string URL = 3;
    string language = 4;
    string releaseTag = 5;
    string buildParam = 6;
    string link = 7;
    int32 sigApproved = 8;
    int32 sigDenied = 9;
    repeated string votersID = 10;
    
    // options for implementer
    bool optionAllowDuplicate = 11;
}

message GetReleaseRequest {
    string releaseID = 1;
}

message DeployRequest {
    string cocoonID = 1;
    string URL = 2;
    string language = 3;
    string releaseTag = 4;
    bytes buildParam = 5;
    string memory = 6;
    string CPUShares = 7;
    string link = 8;
}

message CreateIdentityRequest {
    string email = 1;
    string password = 2;
}

message Response {
    int32 status = 1;
    bytes body = 2;
}
